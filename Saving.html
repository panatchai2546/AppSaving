<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendar and Expense Tracker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f8f5;
            color: #333;
        }

        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px;
        }

        .header img {
            width: 100%;
            max-width: 600px;
            margin-bottom: 20px;
            border-radius: 10px;
        }

        .title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .calendar-container {
            margin-bottom: 20px;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .calendar-header select, .calendar-header button {
            padding: 5px;
            margin: 0 5px;
            border: 1px solid #28a745;
            border-radius: 5px;
            background-color: #28a745;
            color: white;
            cursor: pointer;
        }

        .calendar-header button:hover {
            background-color: #218838;
        }

        .calendar {
            border-collapse: collapse;
            width: 100%;
        }

        .calendar th, .calendar td {
            border: 1px solid #28a745;
            width: 100px;
            height: 100px;
            text-align: center;
            vertical-align: top;
            background-color: white;
            padding: 5px;
            border-radius: 5px;
            position: relative;
        }

        .note {
            font-size: 12px;
            position: absolute;
            bottom: 5px;
            left: 5px;
            right: 5px;
            overflow: hidden;
            text-overflow: ellipsis;
            cursor: text;
        }

        .note, .note div {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
        }

        .expense-tracker {
            width: 100%;
            margin-top: 20px;
        }

        .expense-tracker table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 10px;
        }

        .expense-tracker th, .expense-tracker td {
            border: 1px solid #28a745;
            padding: 8px;
            text-align: center;
        }

        .expense-tracker input, .expense-tracker select, .expense-tracker button {
            padding: 5px;
            margin: 5px;
            border: 1px solid #28a745;
            border-radius: 5px;
        }

        .expense-tracker button {
            background-color: #28a745;
            color: white;
            cursor: pointer;
        }

        .expense-tracker button:hover {
            background-color: #218838;
        }

        .editable {
            cursor: pointer;
        }

        .editable:hover {
            background-color: #f0f0f0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="title">บันทึกวางแผนการเงิน</div>
        <div class="header">
            <img src="Money.jpg" alt="Money Image">
        </div>
        <div class="calendar-container">
            <div class="calendar-header">
                <button id="prevMonth">❮</button>
                <div>
                    <select id="monthSelect"></select>
                    <select id="yearSelect"></select>
                </div>
                <button id="nextMonth">❯</button>
            </div>
            <table class="calendar">
                <thead>
                    <tr>
                        <th>อา</th>
                        <th>จ</th>
                        <th>อ</th>
                        <th>พ</th>
                        <th>พฤ</th>
                        <th>ศ</th>
                        <th>ส</th>
                    </tr>
                </thead>
                <tbody id="calendarBody"></tbody>
            </table>
        </div>
        <div class="expense-tracker">
            <div>
                <input type="text" id="description" placeholder="คำอธิบาย">
                <input type="number" id="amount" placeholder="จำนวนเงิน">
                <select id="type">
                    <option value="income">รายรับ</option>
                    <option value="expense">รายจ่าย</option>
                </select>
                <button onclick="addTransaction()">เพิ่ม</button>
            </div>
            <table>
                <thead>
                    <tr>
                        <th>วันที่</th>
                        <th>คำอธิบาย</th>
                        <th>รายรับ</th>
                        <th>รายจ่าย</th>
                    </tr>
                </thead>
                <tbody id="transactionBody"></tbody>
            </table>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const monthSelect = document.getElementById('monthSelect');
            const yearSelect = document.getElementById('yearSelect');
            const calendarBody = document.getElementById('calendarBody');
            const transactionBody = document.getElementById('transactionBody');

            const months = ["มกราคม", "กุมภาพันธ์", "มีนาคม", "เมษายน", "พฤษภาคม", "มิถุนายน", "กรกฎาคม", "สิงหาคม", "กันยายน", "ตุลาคม", "พฤศจิกายน", "ธันวาคม"];
            const currentYear = new Date().getFullYear();
            const currentMonth = new Date().getMonth();

            months.forEach((month, index) => {
                let option = document.createElement('option');
                option.value = index;
                option.textContent = month;
                monthSelect.appendChild(option);
            });

            for (let i = currentYear - 10; i <= currentYear + 10; i++) {
                let option = document.createElement('option');
                option.value = i;
                option.textContent = i;
                yearSelect.appendChild(option);
            }

            monthSelect.value = currentMonth;
            yearSelect.value = currentYear;

            function generateCalendar(month, year) {
                calendarBody.innerHTML = '';
                const firstDay = new Date(year, month).getDay();
                const daysInMonth = 32 - new Date(year, month, 32).getDate();

                let row = document.createElement('tr');
                for (let i = 0; i < firstDay; i++) {
                    let cell = document.createElement('td');
                    row.appendChild(cell);
                }

                for (let i = 1; i <= daysInMonth; i++) {
                    if ((i + firstDay - 1) % 7 === 0) {
                        calendarBody.appendChild(row);
                        row = document.createElement('tr');
                    }
                    let cell = document.createElement('td');
                    cell.id = `day-${year}-${month}-${i}`;
                    cell.innerHTML = `<div>${i}</div><div id="note-${year}-${month}-${i}" class="note" contenteditable="true" oninput="saveNotes(${year}, ${month}, ${i})"></div>`;
                    row.appendChild(cell);
                }
                calendarBody.appendChild(row);
            }

            monthSelect.addEventListener('change', () => {
                generateCalendar(monthSelect.value, yearSelect.value);
                loadNotes();
                loadTransactions();
            });

            yearSelect.addEventListener('change', () => {
                generateCalendar(monthSelect.value, yearSelect.value);
                loadNotes();
                loadTransactions();
            });

            document.getElementById('prevMonth').addEventListener('click', () => {
                let month = monthSelect.value;
                let year = yearSelect.value;
                if (month == 0) {
                    month = 11;
                    year--;
                } else {
                    month--;
                }
                monthSelect.value = month;
                yearSelect.value = year;
                generateCalendar(month, year);
                loadNotes();
                loadTransactions();
            });

            document.getElementById('nextMonth').addEventListener('click', () => {
                let month = monthSelect.value;
                let year = yearSelect.value;
                if (month == 11) {
                    month = 0;
                    year++;
                } else {
                    month++;
                }
                monthSelect.value = month;
                yearSelect.value = year;
                generateCalendar(month, year);
                loadNotes();
                loadTransactions();
            });

            function addTransaction() {
                const description = document.getElementById('description').value;
                const amount = document.getElementById('amount').value;
                const type = document.getElementById('type').value;
                if (description && amount) {
                    const date = prompt("กรุณาใส่วันที่ (dd-mm-yyyy):");
                    if (date) {
                        const [day, month, year] = date.split('-').map(Number);
                        const noteId = `note-${year}-${month - 1}-${day}`;
                        const noteElement = document.getElementById(noteId);
                        if (noteElement) {
                            const transaction = document.createElement('div');
                            transaction.textContent = `${description}: ${type === 'income' ? '+' : '-'}${amount}`;
                            noteElement.appendChild(transaction);

                            const row = document.createElement('tr');
                            row.innerHTML = `<td>${date}</td><td class="editable" contenteditable="true">${description}</td><td class="editable" contenteditable="true">${type === 'income' ? amount : ''}</td><td class="editable" contenteditable="true">${type === 'expense' ? amount : ''}</td>`;
                            transactionBody.appendChild(row);

                            saveTransaction({ date, description, amount, type });
                        }
                    }
                }
            }

            function saveTransaction(transaction) {
                let transactions = JSON.parse(localStorage.getItem('transactions')) || [];
                transactions.push(transaction);
                localStorage.setItem('transactions', JSON.stringify(transactions));
            }

            function loadTransactions() {
                let transactions = JSON.parse(localStorage.getItem('transactions')) || [];
                transactionBody.innerHTML = '';
                transactions.forEach(({ date, description, amount, type }) => {
                    const [day, month, year] = date.split('-').map(Number);
                    const noteId = `note-${year}-${month - 1}-${day}`;
                    const noteElement = document.getElementById(noteId);
                    if (noteElement) {
                        const transaction = document.createElement('div');
                        transaction.textContent = `${description}: ${type === 'income' ? '+' : '-'}${amount}`;
                        noteElement.appendChild(transaction);

                        const row = document.createElement('tr');
                        row.innerHTML = `<td>${date}</td><td class="editable" contenteditable="true">${description}</td><td class="editable" contenteditable="true">${type === 'income' ? amount : ''}</td><td class="editable" contenteditable="true">${type === 'expense' ? amount : ''}</td>`;
                        transactionBody.appendChild(row);
                    }
                });
            }

            function saveNotes(year, month, day) {
                const noteId = `note-${year}-${month}-${day}`;
                const noteElement = document.getElementById(noteId);
                const notes = noteElement.textContent;
                let savedNotes = JSON.parse(localStorage.getItem('notes')) || {};
                savedNotes[noteId] = notes;
                localStorage.setItem('notes', JSON.stringify(savedNotes));
            }

            function loadNotes() {
                const savedNotes = JSON.parse(localStorage.getItem('notes')) || {};
                for (let noteId in savedNotes) {
                    const noteElement = document.getElementById(noteId);
                    if (noteElement) {
                        noteElement.textContent = savedNotes[noteId];
                    }
                }
            }

            generateCalendar(currentMonth, currentYear);
            loadTransactions();
            loadNotes();
        });
    </script>
</body>
</html>
